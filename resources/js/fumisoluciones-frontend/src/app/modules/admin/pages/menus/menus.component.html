<div class="crud-container">
  <h2>Gestión de Menús</h2>

  <form [formGroup]="form" (ngSubmit)="submit()">
    <p>Label</p>
    <input formControlName="label" placeholder="Label">
    <div *ngIf="form.get('label')?.touched && form.get('label')?.invalid" class="error">
      {{ form.get('label')?.errors?.['required'] ? 'El label es obligatorio.' : form.get('label')?.errors?.['backend'] }}
    </div>

    <p>Route</p>
    <input formControlName="route" placeholder="Route">

    <p>Icon</p>
    <input formControlName="icon" placeholder="Icon">

    <p>Padre</p>
    <select formControlName="parent_id">
      <option [ngValue]="null">-- Sin Padre --</option>
      <option *ngFor="let m of menus" [ngValue]="m.id">{{ m.label }}</option>
    </select>

    <p>Orden</p>
    <input formControlName="orden" type="number" placeholder="Orden">
    <div *ngIf="form.get('orden')?.touched && form.get('orden')?.invalid" class="error">
      {{ form.get('orden')?.errors?.['min'] ? 'El orden no puede ser negativo.' : form.get('orden')?.errors?.['backend'] }}
    </div>

    <button type="submit">
      {{ editingId ? 'Actualizar' : 'Crear' }}
    </button>
    <button type="button" *ngIf="editingId" (click)="cancelEdit()">Cancelar</button>
  </form>

  <ul>
    <li *ngFor="let menu of menus">
      {{ menu.label }} - {{ menu.route }}
      <span *ngIf="menu.parent"> (Hijo de: {{ menu.parent.label }})</span>
      <button (click)="editMenu(menu)">Editar</button>
      <button (click)="deleteMenu(menu.id!)">Eliminar</button>
    </li>
  </ul>
</div>
